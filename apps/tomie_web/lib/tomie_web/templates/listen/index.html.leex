<div class="grid grid-cols-5 gap-4">
  <%= live_component @socket, TomieWeb.ListenLive.SidebarComponent %>

  <div class="col-span-4">
    <div class="chart" phx-update="ignore">
      <script src=" <%= Routes.static_path(TomieWeb.Endpoint, "/js/chartkick.js") %>"></script>
      <script src=" <%= Routes.static_path(TomieWeb.Endpoint, "/js/chart.js") %>"></script>
      <%= raw Chartkick.line_chart Jason.encode!(@sparkline), colors: ["#dd3344"] %>
    </div>

    <%= for listen <- @listens do %>
      <div class="card">
        <div class="flex">
          <div class="image w-16 md:w-32 mr-4 flex-shrink-0">
            <img src="<%= Listens.Albums.get_album_image(listen.album, :large) %>" class="w-full">
          </div>
          <div class="body">
            <h3 class="hyphens"><%= listen.track.name %></h3>
            <p>
              <span class="icon text-on-surface-muted"><%= IconView.icon(:user) %></span>
              <%= live_patch listen.artist.name,
                class: "hover:underline",
                to: Routes.live_path(@socket, TomieWeb.ArtistLive.Show, listen.artist.id) %>
            </p>
            <p>
              <span class="icon text-on-surface-muted"><%= IconView.icon(:vinyl) %></span>
              <%= listen.album.name %>
            </p>
            <div class="tags mt-2">
              <span class="tag"><%= Timex.from_now(listen.listened_at) %></span>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
